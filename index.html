<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>El Pastillero Digital - Sistema de Gestión de Salud</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <nav class="navbar">
    <div class="navbar-brand">
      <i class="fa-solid fa-capsules"></i>
      <span>El Pastillero Digital</span>
    </div>
    <ul class="navbar-menu">
      <li><a href="#/pacientes"><i class="fa-solid fa-users"></i> Pacientes</a></li>
      <li><a href="#/"><i class="fa-solid fa-house"></i> Inicio</a></li>
    </ul>
  </nav>

  <main id="app-main" class="container">
    <!-- Cards/Home -->
    <section id="home-section" class="page" hidden>
      <h1 class="page-title">Panel principal</h1>
      <p class="page-subtitle">Accede a pacientes, signos vitales y medicación</p>
      <div class="cards-grid" id="cards-grid">
        <!-- cards dynamically -->
      </div>
    </section>

    <!-- Pacientes -->
    <section id="pacientes-section" class="page">
      <h1 class="page-title">Pacientes</h1>
      <div id="pacientes-toolbar" class="toolbar">
        <button id="btn-nuevo-paciente" class="btn btn-primary"><i class="fa fa-user-plus"></i> Nuevo paciente</button>
        <input id="buscar-paciente" type="search" placeholder="Buscar paciente..." />
      </div>
      <div id="lista-pacientes" class="list"></div>
    </section>
  </main>

  <!-- Modal Paciente -->
  <div id="modal-paciente" class="modal" aria-hidden="true">
    <div class="modal-dialog">
      <header class="modal-header">
        <h2 id="modal-title">Nuevo paciente</h2>
        <button id="modal-close" class="icon-btn" aria-label="Cerrar"><i class="fa fa-times"></i></button>
      </header>
      <div class="modal-body">
        <form id="form-paciente">
          <div class="field">
            <label>Nombre</label>
            <input name="nombre" required />
          </div>
          <div class="field">
            <label>DNI</label>
            <input name="dni" required />
          </div>
          <div class="field">
            <label>Edad</label>
            <input name="edad" type="number" min="0" />
          </div>
        </form>
      </div>
      <footer class="modal-footer">
        <button id="modal-save" class="btn btn-primary">Guardar</button>
        <button id="modal-cancel" class="btn">Cancelar</button>
      </footer>
    </div>
  </div>

  <script>
    // Simple hash router defaulting to pacientes
    function show(sectionId) {
      document.querySelectorAll('.page').forEach(s => s.hidden = true);
      const el = document.getElementById(sectionId);
      if (el) el.hidden = false;
    }

    function navigate() {
      const hash = location.hash || '#/pacientes';
      if (hash.startsWith('#/pacientes')) show('pacientes-section');
      else show('home-section');
    }

    window.addEventListener('hashchange', navigate);
    // Ensure default route on first load
    if (!location.hash) location.hash = '#/pacientes';
    navigate();

    // Modal wiring
    const modal = document.getElementById('modal-paciente');
    const btnNuevo = document.getElementById('btn-nuevo-paciente');
    const btnClose = document.getElementById('modal-close');
    const btnCancel = document.getElementById('modal-cancel');

    function openModal() {
      modal.setAttribute('aria-hidden', 'false');
      modal.classList.add('open');
    }
    function closeModal() {
      modal.setAttribute('aria-hidden', 'true');
      modal.classList.remove('open');
    }

    btnNuevo && btnNuevo.addEventListener('click', openModal);
    btnClose && btnClose.addEventListener('click', closeModal);
    btnCancel && btnCancel.addEventListener('click', (e) => { e.preventDefault(); closeModal(); });

    // Demo seed for patients list
    const lista = document.getElementById('lista-pacientes');
    if (lista) {
      lista.innerHTML = `
        <div class="card patient">
          <div>
            <strong>Juan Pérez</strong><br/>
            DNI 12345678 · 45 años
          </div>
          <button class="btn btn-light">Ver</button>
        </div>
      `;
    }
  </script>
</body>
</html>
